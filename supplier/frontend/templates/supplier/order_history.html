{% extends 'partials/base.html' %}
<!--  -->
{% load static %}
<!--  -->
{% block title %} Lịch Sử Đơn Hàng {% endblock %}
<!--  -->
{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header">
      <h4><i class="fas fa-history me-2"></i>Lịch Sử Đơn Hàng Đã Xác Nhận</h4>
    </div>
    <div class="card-body">
      {% if messages %}{% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}{% endif %}

      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th>ID Đơn Hàng</th>
              <th>Ngày Xác Nhận</th>
              <th class="text-center">Số Lượng Mặt Hàng</th>
              <th class="text-center">Trạng Thái</th>
              <th class="text-center">Hành Động</th>
            </tr>
          </thead>
          <tbody>
            {% for order in confirmed_orders %}
            <tr>
              <td>#{{ order.id }}</td>
              <td>{{ order.confirmed_at|date:"d/m/Y H:i" }}</td>
              <td class="text-center">{{ order.details.count }}</td>
              <td class="text-center">
                <span
                  class="badge {% if order.status == 'Confirmed' %}bg-info{% elif order.status == 'Received' %}bg-success{% else %}bg-secondary{% endif %}"
                >
                  {{ order.get_status_display }}
                </span>
              </td>
              <td class="text-center">
                <!-- Nút để tải file PDF tem nhãn -->
                <a
                  href="{% url 'supplier:download_delivery_note' order.pk %}"
                  class="btn btn-secondary btn-sm"
                >
                  <i class="fas fa-download me-1"></i> Tải Tem Nhãn (PDF)
                </a>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="5" class="text-center text-muted p-4">
                <em>Bạn chưa xác nhận đơn hàng nào.</em>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
